import java.util.InputMismatchException;
import java.util.Scanner;

public class RegistroVisitasConPotencia {

    static Scanner sc = new Scanner(System.in);
    static int[] tiemposEstadia = new int[7]; // mÃ¡ximo 7 visitas
    static short totalVisitas = 0;
    static int acumuladorMinutos = 0;

    public static void main(String[] args) {

        // Datos personales del visitante
        int cedula = leerEntero("Ingrese su nÃºmero de cÃ©dula (int):");
        byte edad = leerByte("Ingrese su edad (byte):");
        long telefono = leerLong("Ingrese su nÃºmero de telÃ©fono (long):");
        char genero = leerChar("Ingrese su gÃ©nero (char):");
        boolean tieneCita = leerBoolean("Â¿Tiene cita previa? (true/false):");
        float temperatura = leerFloat("Ingrese su temperatura corporal (float):");
        double latitud = leerDouble("Ingrese latitud de ubicaciÃ³n (double):");

        // MenÃº principal
        int opcion;
        do {
            mostrarMenu();
            opcion = leerEntero("Seleccione una opciÃ³n:");

            switch (opcion) {
                case 1:
                    registrarVisita();
                    break;
                case 2:
                    mostrarEstadisticas(cedula, edad, telefono, genero, tieneCita, temperatura, latitud);
                    break;
                case 3:
                    calcularPotenciaDesdeTeclado();
                    break;
                case 4:
                    System.out.println("ðŸ‘‹ Saliendo del programa.");
                    break;
                default:
                    System.out.println("âš ï¸ OpciÃ³n invÃ¡lida.");
            }
        } while (opcion != 4);
    }

    // ======= MÃ©todos de entrada con validaciÃ³n =======
    public static int leerEntero(String mensaje) {
        while (true) {
            try {
                System.out.print(mensaje + " ");
                return sc.nextInt();
            } catch (InputMismatchException e) {
                System.out.println("âš ï¸ Ingrese un nÃºmero entero vÃ¡lido.");
                sc.next();
            }
        }
    }

    public static byte leerByte(String mensaje) {
        while (true) {
            try {
                System.out.print(mensaje + " ");
                return sc.nextByte();
            } catch (InputMismatchException e) {
                System.out.println("âš ï¸ Ingrese un nÃºmero byte vÃ¡lido.");
                sc.next();
            }
        }
    }

    public static long leerLong(String mensaje) {
        while (true) {
            try {
                System.out.print(mensaje + " ");
                return sc.nextLong();
            } catch (InputMismatchException e) {
                System.out.println("âš ï¸ Ingrese un nÃºmero long vÃ¡lido.");
                sc.next();
            }
        }
    }

    public static float leerFloat(String mensaje) {
        while (true) {
            try {
                System.out.print(mensaje + " ");
                return sc.nextFloat();
            } catch (InputMismatchException e) {
                System.out.println("âš ï¸ Ingrese un nÃºmero float vÃ¡lido.");
                sc.next();
            }
        }
    }

    public static double leerDouble(String mensaje) {
        while (true) {
            try {
                System.out.print(mensaje + " ");
                return sc.nextDouble();
            } catch (InputMismatchException e) {
                System.out.println("âš ï¸ Ingrese un nÃºmero double vÃ¡lido.");
                sc.next();
            }
        }
    }

    public static char leerChar(String mensaje) {
        System.out.print(mensaje + " ");
        return sc.next().charAt(0);
    }

    public static boolean leerBoolean(String mensaje) {
        while (true) {
            try {
                System.out.print(mensaje + " ");
                return sc.nextBoolean();
            } catch (InputMismatchException e) {
                System.out.println("âš ï¸ Ingrese true o false.");
                sc.next();
            }
        }
    }

    // ======= MÃ©todos funcionales =======
    public static void mostrarMenu() {
        System.out.println("\n=== MenÃº de Opciones ===");
        System.out.println("1. Registrar nueva visita");
        System.out.println("2. Mostrar estadÃ­sticas");
        System.out.println("3. Calcular potencia (recursivo)");
        System.out.println("4. Salir");
    }

    public static void registrarVisita() {
        if (totalVisitas >= 7) {
            System.out.println("âš ï¸ LÃ­mite de visitas alcanzado.");
            return;
        }

        short depa = leerByte("Ingrese el nÃºmero del departamento (short):");
        byte piso = leerByte("Ingrese el piso (byte):");
        int tiempo = leerEntero("Ingrese el tiempo de estadÃ­a en minutos (int):");

        tiemposEstadia[totalVisitas] = tiempo;
        acumuladorMinutos += tiempo;
        totalVisitas++;

        System.out.println("âœ… Visita registrada.");
    }

    public static void mostrarEstadisticas(int cedula, byte edad, long telefono, char genero,
                                           boolean tieneCita, float temperatura, double latitud) {
        if (totalVisitas == 0) {
            System.out.println("âš ï¸ AÃºn no se han registrado visitas.");
            return;
        }

        float promedio = (float) acumuladorMinutos / totalVisitas;
        boolean mayorEdad = edad >= 18;

        System.out.println("\nðŸ“Š EstadÃ­sticas del Visitante:");
        System.out.println("CÃ©dula: " + cedula);
        System.out.println("Edad: " + edad + (mayorEdad ? " (Mayor de edad)" : " (Menor de edad)"));
        System.out.println("TelÃ©fono: " + telefono);
        System.out.println("GÃ©nero: " + genero);
        System.out.println("Temperatura: " + temperatura + "Â°C");
        System.out.println("Cita previa: " + (tieneCita ? "SÃ­" : "No"));
        System.out.println("Latitud: " + latitud);
        System.out.println("Visitas: " + totalVisitas);
        for (int i = 0; i < totalVisitas; i++) {
            System.out.println("  DÃ­a " + (i + 1) + ": " + tiemposEstadia[i] + " min");
        }
        System.out.printf("Promedio de estadÃ­a: %.2f min\n", promedio);
    }

    public static void calcularPotenciaDesdeTeclado() {
        int base = leerEntero("Ingrese la base (int):");
        int exponente = leerEntero("Ingrese el exponente (int):");

        long resultado = potenciaRecursiva(base, exponente);
        System.out.println("ðŸ”¢ Resultado: " + base + "^" + exponente + " = " + resultado);
    }

    // ======= MÃ©todo recursivo para potencia =======
    public static long potenciaRecursiva(int base, int exponente) {
        if (exponente == 0) {
            return 1;
        } else {
            return base * potenciaRecursiva(base, exponente - 1);
        }
    }
}
